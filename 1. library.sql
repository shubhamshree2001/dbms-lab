BOOK (BOOK_ID, TITLE, PUBLISHER_NAME, PUB_YEAR)
BOOKAUTHORS(BOOK_ID,AUTHOR_NAME)
PUBLISHER(NAME,ADDRESS,PHONE)
BOOK_COPIES(BOOK_ID,BRANCH_ID,NO_OF_COPIES)
BOOK_LENDING(BOOK_ID,BRANCH_ID,CARD_NO,DATE_OUT,DUE_DATE)
LIBRARY_BRANCH(BRANCH_ID,BRANCH_NAME,ADDRESS)

2.Get the particulars of borrowers who have borrowed more than 3 books but from Jan 2017 to Jun          2017


4.Partition the book table based on year of publication.Demostrate its working with a simple query.

5.Create a view all books and its no. of copies that are currently available in the library.

.............................................................................................................................................

CREATE TABLE PUBLISHER(
NAME VARCHAR(20) PRIMARY KEY,
ADDRESS VARCHAR(20),
PHONE NUMBER(10));

CREATE TABLE LIB_BRANCH(
BRANCH_ID NUMBER(2) PRIMARY KEY,
NAME VARCHAR(20) ,
ADDRESS VARCHAR(20));

CREATE TABLE BOOK(
BOOK_ID NUMBER(2) PRIMARY KEY,
TITLE VARCHAR(20),
PUB_NAME VARCHAR(20) REFERENCES PUBLISHER(NAME) ON DELETE CASCADE,
PUB_YEAR NUMBER(4));

CREATE TABLE AUTHORS(
BOOK_ID NUMBER(2) REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE,
NAME VARCHAR(20));

CREATE TABLE BOOK_COPY(
BOOK_ID NUMBER(2) REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE,
BRANCH_ID NUMBER(2) REFERENCES LIB_BRANCH(BRANCH_ID) ON DELETE CASCADE,
NO_OF_COPIES NUMBER(3),
PRIMARY KEY(BOOK_ID,BRANCH_ID));

CREATE TABLE BOOK_LENDING(
BOOK_ID NUMBER(2) REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE,
BRANCH_ID NUMBER(2) REFERENCES LIB_BRANCH(BRANCH_ID) ON DELETE CASCADE,
CARD_NO NUMBER(3),
DATE_OUT DATE,
DUE_DATE DATE,
PRIMARY KEY(BOOK_ID,BRANCH_ID,CARD_NO));


.........................................................................................................................................

INSERT INTO PUBLISHER VALUES ('ABC', 'BANGALORE',123456);
INSERT INTO PUBLISHER VALUES ('ABC1', 'DELHI',1123456);
INSERT INTO PUBLISHER VALUES ('ABC2', 'BANGALORE',1231456);
INSERT INTO PUBLISHER VALUES ('XYZ', 'NOIDA',123456789);
INSERT INTO PUBLISHER VALUES ('ABC4', 'BANGALORE',1123456);
INSERT INTO PUBLISHER VALUES ('ABC5', 'BANGALORE',1231456);

INSERT INTO LIB_BRANCH VALUES(11,'MVIT','BANGLORE');
INSERT INTO LIB_BRANCH VALUES(12,'RNST','BANGLORE');
INSERT INTO LIB_BRANCH VALUES(13,'BMSIT','BANGLORE');
INSERT INTO LIB_BRANCH VALUES(14,'MRIT','BANGLORE');

INSERT INTO BOOK VALUES (1,'DBMS','XYZ',2017);
INSERT INTO BOOK VALUES (2,'XDBMS','XYZ',1992);
INSERT INTO BOOK VALUES (3,'CDBMS','ABC',1998);
INSERT INTO BOOK VALUES (4,'BDBMS','ABC1',1995);
INSERT INTO BOOK VALUES (5,'ADBMS','ABC4',2017);
INSERT INTO BOOK VALUES (6,'SE','ABC',2015);
         
INSERT INTO AUTHORS VALUES(1,'NAVATHE');
INSERT INTO AUTHORS VALUES(2,'NAVATHE');
INSERT INTO AUTHORS VALUES(3,'TANENBAUM');
INSERT INTO AUTHORS VALUES(4,'EDWARD ANGEL');
INSERT INTO AUTHORS VALUES(5,'GALVIN');
            
INSERT INTO BOOK_COPY VALUES(1,11,10);
INSERT INTO BOOK_COPY VALUES(2,11,3);
INSERT INTO BOOK_COPY VALUES(3,12,4);
INSERT INTO BOOK_COPY VALUES(4,13,8);
INSERT INTO BOOK_COPY VALUES(5,14,16);
INSERT INTO BOOK_COPY VALUES(6,13,10);

INSERT INTO  BOOK_LENDING VALUES(1,11,101,'1-JAN-2017','1-JUN-2017');
INSERT INTO  BOOK_LENDING VALUES(2,11,104,'11-JAN-2017','1-JUN-2017');
INSERT INTO  BOOK_LENDING  VALUES(3,12,104,'01-FEB-2017','1-JUN-2017');
INSERT INTO  BOOK_LENDING VALUES(4,13,104,'1-MAR-2017','1-JUN-2017');
INSERT INTO  BOOK_LENDING VALUES(5,14,104,'1-MAR-2017','1-JUN-2017');


......................................................................................................................................................................................
--1
SELECT L.BRANCH_ID ,L.NAME AS BRANCH_NAME ,B.BOOK_ID,A.NAME, B.TITLE, B.PUB_NAME , C.NO_OF_COPIES
FROM BOOK B , LIB_BRANCH L , BOOK_COPY C ,AUTHORS A
WHERE B.BOOK_ID=C.BOOK_ID AND B.BOOK_ID=A.BOOK_ID AND L.BRANCH_ID=C.BRANCH_Id;

--2
SELECT * FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-2017' AND '30-JUN-2017' AND
CARD_NO IN(SELECT CARD_NO FROM BOOK_LENDING 
                           GROUP BY CARD_NO HAVING COUNT(CARD_NO)>3);
            
--3
DELETE FROM BOOK WHERE BOOK_ID ='&BOOK-ID'; 
            
--4
CREATE VIEW PUB_YEARS AS
SELECT PUB_YEAR FROM BOOK;

--5
CREATE VIEW ALL_BOOKS AS
SELECT B.BOOK_ID, B.TITLE,  C.NO_OF_COPIES ,L.NAME AS BRANCH_NAME
FROM BOOK B , LIB_BRANCH L , BOOK_COPY C 
WHERE B.BOOK_ID=C.BOOK_ID AND L.BRANCH_ID=C.BRANCH_ID;
